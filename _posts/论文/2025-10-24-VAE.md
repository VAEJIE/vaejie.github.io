---
layout: post
title: "Auto-Encoding Variational Bayes"
description: 
categories: "论文"
---
## VAE和AE的核心区别在于**潜空间z的表示**
- AE：
    - x映射到确定的、单一的点z
    - z映射回重构的x'  x' = decoder(z)
    - 缺点：浅空间没很好的结构，在浅空间两点之间插值解出来的东西可能毫无意义。
    - **主要用于降维和特征提取，生成新样本的能力很弱**
- VAE：
    - #### Z是潜变量，在VAE中是连续的向量，可看作是**数据X背后隐藏的、未被直接观测到的、但能够解释 X 的抽象因素或特征**，**我们相信Z是X的“原因”或“抽象表示”**
    - Encoder（qφ（Z|X）） 将输入x映射到一个概率分布在潜空间中，通常假设这个分布是高斯分布，所以Encoder输出的是这个高斯分布的均值和方差
    - 从这个分布中采样一个点z
    - Decoder（Pθ（x|z））把z映射回重构的x'
![alt text](/images/posts/论文项目/{0B21FC60-65D9-4AEE-AB83-5381CFBD8FC7}.png)



-----------------------------------------------
## 前置知识
P（z）：先验，没有看到数据X时，对潜变量Z的假设，在VAE中，我们假设Z服从标准正态分布 
P（x|z）：似然，给了z后生成x的概率，VAE中是decoder实现的
P（z|x）：后验，观测到x后对潜变量z的推断，“既然有了x，那么它最有可能是由什么样的z生成的”，VAE中，我们用编码器Encoder（qφ（Z|X））来近似这个真实的、不可计算的后验
P（x）：证据/边缘似然，生成X的总概率，不管z是啥
![alt text](/images/posts/论文项目/Bayes.png)

P（X）不可解的原因：Z通常是高维连续变量，求高维积分是不可的


#### 既然后验概率P（Z|X）算不出来，就假设一个分布qφ（Z|X）去近似这个真实值概率
策略：用一个标准来衡量二者有多接近，此标准为：**KL（散度）**
优化：通过调整参数φ去使KL最小
![alt text](/images/posts/论文项目/KL.png)
##### KL的作用是对编码器φ施加一个正则化约束，强制浅空间的结构化
![alt text](/images/posts/论文项目/whyKL.png)

#### 证据下界（ELBO，evidence lower bound） 
![alt text](/images/posts/论文项目/ELBO.png)
![alt text](/images/posts/论文项目/ELBO2.png)
**最大化log（P（x）） = 最大化ELBO = 最小化损失**
![alt text](/images/posts/论文项目/与cmssl损失函数.png)
-------------------------



## 痛点
在概率建模中，我们经常想知道“是什么样的潜在因素 z导致了我们观测到的数据 "x”。例如，潜在因素 z 可能是“图片中的人脸姿态”，而 x 是“这张人脸的像素”。在数学上，这就是计算后验概率 p(z|x)。然而，对于复杂的模型（比如用神经网络定义的模型），这个计算需要求解一个极其复杂甚至不可能的积分，这就是“不可解性”（intractability）

------------------------------
## 介绍：
- VAE ———— 变分自编码器。  基于变分贝叶斯推断的生成模型
- 通过学习数据的**潜在分布**，将输入编码成**概率分布**而不是**固定向量**，再通过解码器从该分布采样重建数据。

#### 创新点
- ##### 训练算法：AEVB（Auto-Encoding VB）
- ##### 目标函数：SGVB估计器
#### 损失函数
![alt text](/images/posts/论文项目/{B397900D-1510-45D7-9731-0F03EC35AB28}.png)
![alt text](/images/posts/论文项目/{45218DD0-79D1-4133-BD4F-0471C471CB14}.png)

#### 重参数化技巧
VAE能用梯度下降训练的关键
  - 问题：VAE中，从编码器定义的分布qφ（Z|X）中采样一个Z然后送到解码器去计算重构损失，但采样本身是随机的、不可导的。梯度无法从解码器通过“采样”反向传播回去更新均值、方差、参数φ
  - 解决方法：
    ![alt text](/images/posts/论文项目重参数化技巧.png)

