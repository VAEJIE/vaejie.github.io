---
layout: post
title: "CROSS-MODALITY SELF-SUPERVISION FOR UNIMODAL PHYSIOLOGICAL SIGNALS REPRESENTATION LEARNING"
description: 
categories: "论文"
---
## 创新点
1. 首次提出利用跨模态（ECG+PPG）自监督预训练来增强单模态生理信号表示学习框架
2. 设计了一个共享的跨模态离散令牌码本
3. 两阶段学习策略，将跨模态知识有效迁移到单模态模型中
-----------------------------
## 与SSL范式的关系： 
    - **CM-SSL**的第一阶段采用的是生成式/重构式的SSL范式，目标是从**离散码本**重构原始信号 ，这与-**VQ-VAE**类似。这与主要依赖对比学习的范式（如SimCLR, MoCo, TFC ，以及PaPaGei ）形成对比。
    **HeartLang**: 两者都使用了VQ/Tokenization ，但HeartLang基于心跳分词（单模态ECG） ，而CM-SSL基于固定片段分词（跨模态ECG+PPG预训练）
    **PaPaGei**: PaPaGei使用对比学习处理PPG ，学习连续表示；CM-SSL使用生成式重构处理ECG+PPG，并在第一阶段学习离散表示。 
    **ST-MEM**：使用MAE处理ECG，直接重构掩码信号 ；CM-SSL使用类似VQ-VAE的重构和伪标签预测

-----------------------
## 痛点
- **核心痛点**： 现有SSL方法通常只用单一信号模态，无法捕捉不同生理信号（如ECG与PPG）间的互补信息和生理关联，导致模型泛化能力和性能受限 。

- 实际部署痛点： 传统多模态模型在推理时也需要所有模态输入，但在实际应用中往往只能获取单模态信号，限制了实用性 。

- 通用痛点： 监督学习依赖稀缺昂贵的标注数据
-------------------------------------
## 流程
1. #### 跨模态分词器预训练
![alt text](/images/posts/论文项目/分词器预训练.png)

2. #### 单模态表示学习
![alt text](/images/posts/论文项目/单模态表示学习.png)

3. #### 下游任务应用
训练完成后，丢弃阶段一的模型和阶段二的分类头，仅保留阶段二训练好的单模态ViT编码器作为特征提取器，用于下游任务的微调或线性探测


-----------------------------------------
## 方法
- #### 核心机制：
        提出**共享的跨模态令牌词汇表（码本）**，通过联合处理同步的ECG和PPG信号学习离散的、模态不变的生理模式表示
- #### 框架设计：
        采用两阶段：
            1. 用跨模态数据预训练分词器和码本（生成式重构）
            2. 知识迁移到单模态，通过预测码本索引进行训练
    **训练过程描述:**
        1. 训练分词器和码本（VQ-VAE）
        2. 冻结这个训练好的分词器（他的参数不会再更新）
        3. **使用双模态信号**，输入这个分词器
        4. 得到这个双模态信号的离散码本（称作伪标签）
        5. 这时再训练一个新的模型（ViT.......）
        6.拿一段**单模态信号**，patching后输入模型，以第4步的伪标签作为“真实答案”，让这个新模型去预测对应的那个联合码本索引是什么，这是个*分类任务*，损失函数是交叉熵
        7.训练完成，最后的这个新模型是个**“基于双模态共享码本的可理解单模态信号的蒸馏学生模型”**
###### 跨模态数据进行预训练，最终目的是为了增强“unimodal representations”（单模态表示），使其在只使用单模态的情况下也能表现出色  


--------------------------------------
## 批判性分析
#### 优点
    - **巧妙解决模态缺失**： “训练多模态，推理单模态”的设计非常实用，克服了许多多模态模型在实际部署中的主要障碍
    - **利用生理耦合**： 明确利用ECG和PPG之间的生理关联作为跨模态学习的基础，使得学习到的表示更具生理意义
    - **共享离散码本**： 使用VQ构建共享码本，既实现了信息融合，又将连续信号有效地对接到了基于Transformer的架构
#### 局限性
    - **依赖同步数据**： CM-SSL的预训练强依赖于大规模、时间精确同步的ECG和PPG数据对。这类数据的获取难度和成本可能比单模态数据更高，论文未详细讨论预训练数据的来源和规模，也未探讨对同步精度不敏感的策略
    - **VQ的固有局限**： VQ过程是有损压缩，可能丢失信号中的细微信息。码本大小（K）的选择对性能至关重要，但论文似乎没有深入探讨其影响。此外，VQ训练可能面临码本崩溃（codebook collapse）等问题，论文未讨论如何解决
    - **固定的Patching策略**： 像许多基于ViT的模型一样，CM-SSL使用固定的窗口分割信号 。这可能无法完美对齐生理事件（如心跳），可能不如HeartLang基于QRS检测的分割策略更能保留语义信息
    - **两阶段训练的复杂性**： 相对于端到端的单阶段SSL方法，两阶段训练流程更复杂，引入了额外的超参数和潜在的次优问题（第一阶段的最优不一定导致第二阶段的最优）
    - **乏对噪声的明确处理**： 论文没有明确讨论模型在存在显著噪声或伪影（如运动伪影）情况下的鲁棒性，而这在真实世界生理信号中非常普遍 。共享码本能否有效过滤噪声还是会编码噪声模式