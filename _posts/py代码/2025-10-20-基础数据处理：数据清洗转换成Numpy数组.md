---
layout: post
title: "基础数据处理：数据清洗转换成Numpy数组"
description: ""
categories: "py代码"
---
{% include JB/setup %}
### 基础数据处理：数据清洗转换成Numpy数组
>分别获取数据中的特征值X和标签值Y
>```python
>X = np.array([[float(x) for x in s[:-1]] for s in data[:cfg.data_size]], np.float32)
>Y = np.array([label_map[s[-1]] for s in data[:cfg.data_size]], np.int32)
>```

“解压缩”后的代码
>```
>X_list = []
>for s in data[:cfg.data_size]:  # 遍历每一行数据，s 是一行，比如 ['5.1', '3.5', '1.4', '0.2', 'setosa']
>    features_str = s[:-1]      # 取出除最后一个元素外的所有元素，得到 ['5.1', '3.5', '1.4', '0.2']
>    
>    features_float = []
>    for x in features_str:     # 遍历这个特征列表
>        features_float.append(float(x)) # 把每个字符串 '5.1' 转换成浮点数 5.1
>    
>    X_list.append(features_float) # 把这一行的浮点数特征加到总列表里
># 最后，用 np.array 转换成 NumPy 数组，并指定数据类型为 float32
>X = np.array(X_list, dtype=np.float32)
>```


“解压缩”后的代码
>```
>Y_list = []
>for s in data[:cfg.data_size]:  # 遍历每一行数据
>    label_str = s[-1]          # 取出最后一个元素，即标签字符串 'setosa'
>    label_int = label_map[label_str] # 使用字典 label_map {'setosa': 0, ...} 查找对应的数字 0
>    Y_list.append(label_int)   # 把这个数字加到总列表里
>
># 最后，转换成 NumPy 数组，并指定数据类型为 int32
>Y = np.array(Y_list, dtype=np.int32)
>```


### Mindspore框架API工具
生成训练集
>```
>XY_train = list(zip(X_train, Y_train))
>ds_train = dataset.GeneratorDataset(XY_train, ['x', 'y'])
>```

打乱操作并设定batchsize
```
ds_train = ds_train.shuffle(buffer_size=cfg.train_size).batch(cfg.batch_size, drop_remainder=True)
```
**shuffle是在打乱，batch是在分批，每多少个作为一个batch送给模型**